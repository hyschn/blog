---
title: 新词发现用于搜索优化
tags: NLP
key: 20181101
---
## 搜索引擎中的分词
### 为什么要分词
用百度的说法就是,搜索引擎分词技术是对于用户提交查询的关键词串进行查询处理后，根据用户的关键词串用各种匹配方法进行处理的一种技术。

![image](https://user-images.githubusercontent.com/9245002/65689378-8b1f0a80-e09f-11e9-996e-ab95b53d29c8.png)

分词是为了让搜索引擎能够理解用户查询的意图,从而返回匹配的结果.一般来说,用户查询的语句不可能和待搜索的内容完全相等,这就需要在查询和可能的结果之间建立一种映射关系,这种映射关系就是基于"词"的.如果查询语句分词之后包含哪些词,且某个索引文档分词之后也包含这些词,搜索引擎就将其作为结果返回——当然,实际情况要复杂的多,还包括布尔搜索,范围搜索,相关性排序等,但是这些都是建立在分词的基础之上.

### ik的两种分词模式
我们的搜索引擎Elasticsearch中文分词采用IK分词,IK分词器有2种分词模式:
>ik_max_word: 会将文本做最细粒度的拆分，比如会将“中华人民共和国国歌”拆分为“中华人民共和国,中华人民,中华,华人,人民共和国,人民,人,民,共和国,共和,和,国国,国歌”，会穷尽各种可能的组合；  
>ik_smart: 会做最粗粒度的拆分，比如会将“中华人民共和国国歌”拆分为“中华人民共和国,国歌”。

索引时，为了提供索引的覆盖范围，通常会采用ik_max_word分析器，会以最细粒度分词索引，搜索时为了提高搜索准确度，会采用ik_smart分析器.如果不采用这种分词方式会产生什么问题呢,举个例子🌰,假如我们使用ik_smart为 **"QuestMobile中国移动互联网2018年秋季大报告发布，快看漫画位居行业第一"** 这句话建立索引,结果应该是:
> QuestMobile//中国移动互联网//2018年秋季//大报告//发布//快看漫画//位居//行业//第一

按照这种分词方式,我们搜索"移动互联网","快看"都是搜不到这条结果的,而实际上他们应该是相关的.  
假如我们使用ik_max_word对查询进行分词,可能会搜出来一些无关的干扰信息.比如我在快看漫画社区搜索"人民大学",显然我是想要搜索国内某985高校的相关帖子,然鹅返回的两条结果,真的和人大没有任何关系,只是帖子的内容里面恰好出现了"人民"和"大学"两个词罢了.

![image](https://user-images.githubusercontent.com/9245002/65689403-98d49000-e09f-11e9-80f5-d0bead59f239.png)

![image](https://user-images.githubusercontent.com/9245002/65689411-9d994400-e09f-11e9-8a61-880786843bfb.png)

## 新词发现
所谓的新词发现,也是一种分词手段.分词理论上可以基于词典,基于语法或者基于统计,但是基于语法的方法,emmm,不太好用(特别是对汉语这么复杂的语法规则来说),所以基本被抛弃了.然后基于词典(字符串匹配)和基于统计(信息熵)的方法各有利弊.基于词典的方法比较直观,分出来的词一定是词典中存在的,不会出现一些奇怪的词.但是它无法分辨出词典中没有的,而实际上已经被大家所接受的心生的词语.基于统计的方法可以做到这一点,因为它是通过一种无监督的方法发现词的,一个字符串是不是词,只和它出现的频率,上下文及内部结构有关.

根据上次新词发现测试的结果,我们发现了"王宝强"这个人名可以作为一个词.不过目前我们的系统中还没有这个词,看一下下面的搜索结果.发现第一条结果并未包含"王宝强"这个词,但是出现了"宝强哥哥",是不是感觉很人性化😂.抱歉,我们的系统并没有做同义词匹配,出现这个仅仅是巧合罢了.  
实际上,"王宝强"这个词是被分成了"王","宝","强"三个字,然后再用这三个字去匹配所有帖子的内容.所以,可以看到,被我标记为"2"的帖子并没有出现"王宝强",而且内容和王宝强没有半毛钱关系,仅仅出现了"强"(强哥)和"王"(海贼王)这两个字,所以它出现在了搜索结果里面,并且,居然还排在了真正和王宝强有关的帖子前面(下面那条就是).4号和5号帖子也是同样的情况.

![screenshot_2018-11-01-15-10-51-986_com kuaikan comic](https://user-images.githubusercontent.com/9245002/47839283-2c003980-dded-11e8-920f-f7630880a010.png)

## 参考资料
[什么是搜索引擎分词技术？](https://blog.csdn.net/u011277123/article/details/78095849)  
[中文分词与搜索引擎](http://www.voidcn.com/article/p-cxcmrtho-so.html)  
[ElesticSearch IK中文分词使用详解](https://blog.csdn.net/xsdxs/article/details/72853288#commentBox)